<!DOCTYPE html>
<html>
<head>
  <title>Machine Learning with R - II</title>
  <meta charset="utf-8">
  <meta name="description" content="Machine Learning with R - II">
  <meta name="author" content="Ilan Man">
  <meta name="generator" content="slidify" />
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta http-equiv="X-UA-Compatible" content="chrome=1">
  <link rel="stylesheet" href="libraries/frameworks/io2012/css/default.css" media="all" >
  <link rel="stylesheet" href="libraries/frameworks/io2012/phone.css" 
    media="only screen and (max-device-width: 480px)" >
  <link rel="stylesheet" href="libraries/frameworks/io2012/css/slidify.css" >
  <link rel="stylesheet" href="libraries/highlighters/highlight.js/css/tomorrow.css" />
  <base target="_blank"> <!-- This amazingness opens all links in a new tab. -->
  <script data-main="libraries/frameworks/io2012/js/slides" 
    src="libraries/frameworks/io2012/js/require-1.0.8.min.js">
  </script>
  
    
</head>
<body style="opacity: 0">
  <slides class="layout-widescreen">
    
    <!-- LOGO SLIDE -->
    <!-- END LOGO SLIDE -->
    

    <!-- TITLE SLIDE -->
    <!-- Should I move this to a Local Layout File? -->
    <slide class="title-slide segue nobackground">
      <hgroup class="auto-fadein">
        <h1>Machine Learning with R - II</h1>
        <h2></h2>
        <p>Ilan Man<br/>Strategy Operations  @ Squarespace</p>
      </hgroup>
          </slide>

    <!-- SLIDES -->
      <slide class="" id="slide-1" style="background:;">
  <hgroup>
    <h2>Agenda</h2>
  </hgroup>
  <article>
    <p><space></p>

<ol>
<li>Logistic Regression</li>
<li>Principle Component Analysis</li>
<li>Clustering</li>
<li>Trees</li>
</ol>

  </article>
  <!-- Presenter Notes -->
</slide>

      <slide class="" id="slide-2" style="background:;">
  <hgroup>
    <h2>Objectives</h2>
  </hgroup>
  <article>
    <p><space></p>

<ol>
<li>Understand some popular algorithms and techniques</li>
<li>Learn how to tune parameters</li>
<li>Practice R</li>
</ol>

  </article>
  <!-- Presenter Notes -->
</slide>

      <slide class="" id="slide-3" style="background:;">
  <hgroup>
    <h2>Logistic Regression</h2>
  </hgroup>
  <article>
    <h1>Motivation</h1>

<p><space></p>

<pre><code class="r">x &lt;- 1:10
log_ex &lt;- data.frame(Y = c(rnorm(5, 0, 0.01), rnorm(5, 5, 0.01)), X = x)
ggplot(log_ex, aes(X, Y)) + geom_point(color = &quot;blue&quot;, size = 3) + stat_smooth(method = &quot;lm&quot;, 
    se = F, color = &quot;green&quot;, size = 1)
</code></pre>

<pre><code>## Error: could not find function &quot;ggplot&quot;
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

      <slide class="" id="slide-4" style="background:;">
  <hgroup>
    <h2>Logistic Regression</h2>
  </hgroup>
  <article>
    <h1>Motivation</h1>

<p><space></p>

<pre><code class="r">library(&quot;MASS&quot;)
library(ggplot2)
data(menarche)
log_data &lt;- data.frame(Y = menarche$Menarche/menarche$Total)
log_data$X &lt;- menarche$Age

glm.out &lt;- glm(cbind(Menarche, Total - Menarche) ~ Age, family = binomial(logit), 
    data = menarche)
lm.out &lt;- lm(Y ~ X, data = log_data)

log_data$fitted &lt;- glm.out$fitted

data_points &lt;- ggplot(log_data) + geom_point(aes(x = X, y = Y), color = &quot;blue&quot;, 
    size = 3)
line_points &lt;- data_points + geom_abline(intercept = coef(lm.out)[1], slope = coef(lm.out)[2], 
    color = &quot;green&quot;, size = 1)
curve_points &lt;- line_points + geom_line(aes(x = X, y = fitted), color = &quot;red&quot;, 
    size = 1)
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

      <slide class="" id="slide-5" style="background:;">
  <hgroup>
    <h2>Logistic Regression</h2>
  </hgroup>
  <article>
    <h1>Notation</h1>

<p><space></p>

<ul>
<li>type of regression to predict the probability of being in a class

<ul>
<li>typical to set threshold to 0.5</li>
</ul></li>
<li>assumes error terms are Binomially distributed

<ul>
<li>which generates 1&#39;s and 0&#39;s as the error term</li>
</ul></li>
<li>sigmoid or logistic function: \(g(z) = \frac{1}{1+e^{-z}}\)

<ul>
<li>interpret the output as \(P(Y=1 | X)\)</li>
<li>bounded by 0 and 1</li>
</ul></li>
</ul>

  </article>
  <!-- Presenter Notes -->
</slide>

      <slide class="" id="slide-6" style="background:;">
  <hgroup>
    <h2>Logistic Regression</h2>
  </hgroup>
  <article>
    <h1>Notation</h1>

<p><space></p>

<pre><code class="r">curve(1/(1 + exp(-x)), from = -10, to = 10, ylab = &quot;P(Y=1|X)&quot;, col = &quot;red&quot;, 
    lwd = 3)
abline(a = 0.5, b = 0, lty = 2, col = &quot;blue&quot;, lwd = 3)
</code></pre>

<p><img src="figure/log_curve.png" alt="plot of chunk log_curve"> </p>

  </article>
  <!-- Presenter Notes -->
</slide>

      <slide class="" id="slide-7" style="background:;">
  <hgroup>
    <h2>Logistic Regression</h2>
  </hgroup>
  <article>
    <h1>Find parameters</h1>

<p><space></p>

<ul>
<li>The hypothesis function, \(h_{\theta}(x)\), is P(Y=1|X)</li>
<li>Linear Regression --&gt; \(h_{\theta}(x) = \theta x^{T}\)</li>
<li>Logistic Regression --&gt; \(h_{\theta}(x) = g(\theta x^{T})\) 
<br>
where \(g(z) = \frac{1}{1+e^{-z}}\)</li>
</ul>

  </article>
  <!-- Presenter Notes -->
</slide>

      <slide class="" id="slide-8" style="background:;">
  <hgroup>
    <h2>Logistic Regression</h2>
  </hgroup>
  <article>
    <h1>Notation</h1>

<p><space></p>

<ul>
<li>Re-arranging \(Y = \frac{1}{1+e^{-\theta x^{T}}}\) yields \(\log{\frac{Y}{1 - Y}} = \theta x^{T}\)<br></li>
<li>&quot;log odds&quot;&quot; are linear in X</li>
<li>this is called the logit of theta

<ul>
<li>links X linearly with some function of Y</li>
</ul></li>
</ul>

  </article>
  <!-- Presenter Notes -->
</slide>

      <slide class="" id="slide-9" style="background:;">
  <hgroup>
    <h2>Logistic Regression</h2>
  </hgroup>
  <article>
    <h1>Find parameters</h1>

<p><space></p>

<ul>
<li>So \(h_{\theta}(x) = \frac{1}{1+e^{-\theta x^{T}}}\)</li>
<li>What is the cost function?</li>
<li>Why can&#39;t we use the same cost function as for the linear hypothesis?

<ul>
<li>logistic residuals are Binomially distributed - not Normal</li>
<li>the regression function is not linear in X</li>
</ul></li>
</ul>

  </article>
  <!-- Presenter Notes -->
</slide>

      <slide class="" id="slide-10" style="background:;">
  <hgroup>
    <h2>Logistic Regression</h2>
  </hgroup>
  <article>
    <h1>Find parameters</h1>

<p><space></p>

<ul>
<li>Define logistic cost function as:</li>
</ul>

<p>\(cost(h_{\theta}(x)):\)<br>
&nbsp;&nbsp; \(= -\log(x),\) &nbsp;&nbsp;&nbsp;  \(y = 1\)<br>
&nbsp;&nbsp; \(= -\log(1-x),\) &nbsp;   \(y = 0\)</p>

<p><img src="figure/cost_curves1.png" alt="plot of chunk cost_curves"> <img src="figure/cost_curves2.png" alt="plot of chunk cost_curves"> </p>

  </article>
  <!-- Presenter Notes -->
</slide>

      <slide class="" id="slide-11" style="background:;">
  <hgroup>
    <h2>Logistic Regression</h2>
  </hgroup>
  <article>
    <h1>Find parameters</h1>

<p><space></p>

<ul>
<li>using statistics, it can be shown that<br>
\(cost(h_{\theta}(x), y) = -y \log(h_{\theta}(x)) + (1-y) \log(1-h_{\theta}(x))\)<br></li>
</ul>

  </article>
  <!-- Presenter Notes -->
</slide>

      <slide class="" id="slide-12" style="background:;">
  <hgroup>
    <h2>Logistic Regression</h2>
  </hgroup>
  <article>
    <h1>Find parameters</h1>

<p><space></p>

<ul>
<li>using statistics, it can be shown that<br>
\(cost(h_{\theta}(x), y) = -y \log(h_{\theta}(x)) + (1-y) \log(1-h_{\theta}(x))\)<br></li>
<li>Logistic regression cost function is then<br>
\(cost(h_{\theta}(x), y)  = \frac{1}{m} \sum_{i=1}^{m} -y \log(h_{\theta}(x)) + (1-y) \log(1-h_{\theta}(x))\)</li>
</ul>

  </article>
  <!-- Presenter Notes -->
</slide>

      <slide class="" id="slide-13" style="background:;">
  <hgroup>
    <h2>Logistic Regression</h2>
  </hgroup>
  <article>
    <h1>Find parameters</h1>

<p><space></p>

<ul>
<li>using statistics, it can be shown that<br>
\(cost(h_{\theta}(x), y) = -y \log(h_{\theta}(x)) + (1-y) \log(1-h_{\theta}(x))\)<br></li>
<li>Logistic regression cost function is then<br>
\(cost(h_{\theta}(x), y)  = \frac{1}{m} \sum_{i=1}^{m} -y \log(h_{\theta}(x)) + (1-y) \log(1-h_{\theta}(x))\)</li>
<li>Minimize the cost</li>
</ul>

  </article>
  <!-- Presenter Notes -->
</slide>

      <slide class="" id="slide-14" style="background:;">
  <hgroup>
    <h2>Logistic Regression</h2>
  </hgroup>
  <article>
    <h1>Gradient descent</h1>

<p><space></p>

<p><img src="figure/grad_ex_plot.png" alt="plot of chunk grad_ex_plot"> </p>

  </article>
  <!-- Presenter Notes -->
</slide>

      <slide class="" id="slide-15" style="background:;">
  <hgroup>
    <h2>Logistic Regression</h2>
  </hgroup>
  <article>
    <h1>Gradient descent</h1>

<p><space></p>

<pre><code class="r">x &lt;- cbind(1, x)  #Add ones to x  
theta &lt;- c(0, 0)  # initalize theta vector 
m &lt;- nrow(x)  # Number of the observations 
grad_cost &lt;- function(X, y, theta) return(sum(((X %*% theta) - y)^2))
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

      <slide class="" id="slide-16" style="background:;">
  <hgroup>
    <h2>Logistic Regression</h2>
  </hgroup>
  <article>
    <h1>Gradient descent</h1>

<p><space></p>

<pre><code class="r">gradDescent &lt;- function(X, y, theta, iterations, alpha) {
    m &lt;- length(y)
    grad &lt;- rep(0, length(theta))
    cost.df &lt;- data.frame(cost = 0, theta = 0)

    for (i in 1:iterations) {
        h &lt;- X %*% theta
        grad &lt;- (t(X) %*% (h - y))/m
        theta &lt;- theta - alpha * grad
        cost.df &lt;- rbind(cost.df, c(grad_cost(X, y, theta), theta))
    }

    return(list(theta, cost.df))
}
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

      <slide class="" id="slide-17" style="background:;">
  <hgroup>
    <h2>Logistic Regression</h2>
  </hgroup>
  <article>
    <h1>Gradient descent</h1>

<p><space></p>

<pre><code class="r">## initialize X, y and theta
X1 &lt;- matrix(ncol = 1, nrow = nrow(df), cbind(1, df$X))
Y1 &lt;- matrix(ncol = 1, nrow = nrow(df), df$Y)

init_theta &lt;- as.matrix(c(0))
grad_cost(X1, Y1, init_theta)
</code></pre>

<pre><code>[1] 5187
</code></pre>

<pre><code class="r">
iterations = 100
alpha = 0.1
results &lt;- gradDescent(X1, Y1, init_theta, iterations, alpha)
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

      <slide class="" id="slide-18" style="background:;">
  <hgroup>
    <h2>Logistic Regression</h2>
  </hgroup>
  <article>
    <h1>Gradient descent</h1>

<p><space></p>

<pre><code>## Error: object &#39;cost.df&#39; not found
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

      <slide class="" id="slide-19" style="background:;">
  <hgroup>
    <h2>Logistic Regression</h2>
  </hgroup>
  <article>
    <h1>Gradient descent</h1>

<p><space></p>

<pre><code class="r">grad_cost(X1, Y1, theta[[1]])
</code></pre>

<pre><code>[1] 300
</code></pre>

<pre><code class="r">## Make some predictions
intercept &lt;- df[df$X == 0, ]$Y
pred &lt;- function(x) return(intercept + c(x) %*% theta)
new_points &lt;- c(0.1, 0.5, 0.8, 1.1)
new_preds &lt;- data.frame(X = new_points, Y = sapply(new_points, pred))
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

      <slide class="" id="slide-20" style="background:;">
  <hgroup>
    <h2>Logistic Regression</h2>
  </hgroup>
  <article>
    <h1>Gradient descent</h1>

<p><space></p>

<pre><code class="r">ggplot(data = df, aes(x = X, y = Y)) + geom_point(size = 2)
</code></pre>

<p><img src="figure/new_point1.png" alt="plot of chunk new_point"> </p>

<pre><code class="r">ggplot(data = df, aes(x = X, y = Y)) + geom_point() + geom_point(data = new_preds, 
    aes(x = X, y = Y, color = &quot;red&quot;), size = 3) + scale_colour_discrete(guide = FALSE)
</code></pre>

<p><img src="figure/new_point2.png" alt="plot of chunk new_point"> </p>

  </article>
  <!-- Presenter Notes -->
</slide>

      <slide class="" id="slide-21" style="background:;">
  <hgroup>
    <h2>Regression example</h2>
  </hgroup>
  <article>
    <h1>Gradient descent - summary</h1>

<p><space></p>

<ul>
<li>minimization algorithm</li>
<li>approximation, non-closed form solution</li>
<li>good for large number of examples</li>
<li>hard to select the right \(\alpha\)</li>
<li>traditional looping is slow - optimization algorithms are used in practice</li>
</ul>

  </article>
  <!-- Presenter Notes -->
</slide>

      <slide class="" id="slide-22" style="background:;">
  <hgroup>
    <h2>Logistic Regression</h2>
  </hgroup>
  <article>
    <h1>Summary</h1>

<p><space></p>

<ul>
<li>very popular classification algorithm</li>
<li>based on Binomial error terms, i.e. 1&#39;s and 0&#39;s</li>
</ul>

  </article>
  <!-- Presenter Notes -->
</slide>

      <slide class="" id="slide-23" style="background:;">
  <hgroup>
    <h2>Principle Component Analysis</h2>
  </hgroup>
  <article>
    <h1>Motivation</h1>

<p><space></p>

<ul>
<li>used widely in modern data analysis</li>
<li>not well understood</li>
<li>intuition: reduce data into only relevant dimensions</li>
<li>the goal of PCA is to compute the most meaningful was to re-express noisy data, revealing the hidden structure</li>
</ul>

  </article>
  <!-- Presenter Notes -->
</slide>

      <slide class="" id="slide-24" style="background:;">
  <hgroup>
    <h2>Principle Component Analysis</h2>
  </hgroup>
  <article>
    <h1>Concepts</h1>

<p><space></p>

<ul>
<li>first big assumption: linearity</li>
<li>\(PX=Y\)

<ul>
<li>\(X\) is original dataset, \(P\) is a transformation of \(X\) into \(Y\)</li>
</ul></li>
<li>how do we choose \(P\)?

<ul>
<li>reduce noise</li>
<li>maximize variance</li>
</ul></li>
</ul>

  </article>
  <!-- Presenter Notes -->
</slide>

      <slide class="" id="slide-25" style="background:;">
  <hgroup>
    <h2>Principle Component Analysis</h2>
  </hgroup>
  <article>
    <h1>Concepts</h1>

<p><space></p>

<ul>
<li><p>covariance matrix</p>

<ul>
<li>\(C = X*X^{T}\)</li>
</ul></li>
<li><p>restated goals are</p>

<ul>
<li>minimize covariance and maximize variance</li>
<li>the optimizal \(C\) is a diagonal matrix, off diagonals are = 0</li>
</ul></li>
</ul>

<hr>

<h2>Principle Component Analysis</h2>

<h1>Concepts</h1>

<p><space></p>

<ul>
<li>summary of assumptions

<ul>
<li>linearity (non-linear is a kernel PCA)</li>
<li>largest variance indicates most signal, low variance = noise</li>
<li>orthogonal components - makes the linear algebra easier</li>
<li>assumes data is normally distributed, otherwise PCA might not diagonalize matrix</li>
<li>can use ICA</li>
<li>but most data is normal and PCA is robust to slight deviance from normality</li>
</ul></li>
</ul>

  </article>
  <!-- Presenter Notes -->
</slide>

      <slide class="" id="slide-26" style="background:;">
  <hgroup>
    <h2>Principle Component Analysis</h2>
  </hgroup>
  <article>
    <h1>Eigenwhat?</h1>

<p><space></p>

<ul>
<li>\(Ax = \lambdax\)

<ul>
<li>\(\lambda\) is an eigenvalue of \(A\) and \(x\) is an eigenvector of \(A\)</li>
</ul></li>
<li>\(Ax - \lambdaIx = 0\)</li>
<li>\((A - \lambdaI)x = 0\)</li>
<li>\(\det(A - \lambdaI)\) = 0</li>
</ul>

  </article>
  <!-- Presenter Notes -->
</slide>

      <slide class="" id="slide-27" style="background:;">
  <hgroup>
    <h2>Principle Component Analysis</h2>
  </hgroup>
  <article>
    <h1>Eigenwhat?</h1>

<p><space></p>

<p>\(\[A=\left[{\begin{array}{cc}5 & 2 \\2 & 5\\\end{array}\right ]\]\)</p>

<p>A = matrix(c(5,2,2,5),nrow=2)
I = diag(nrow(A))
|A - L<em>I| = 0
det(c(5-l,2,2,5-l))
(5-l)</em>(5-l) - 4 = 0
25 - 10l + l<sup>2</sup> - 4 = 0
l<sup>2</sup> - 10l + 21 = 0
roots &lt;- Re(polyroot(c(21,-10,1)))</p>

<pre><code></code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

      <slide class="" id="slide-28" style="background:;">
  <hgroup>
    <h2>Principle Component Analysis</h2>
  </hgroup>
  <article>
    <h1>Eigenwhat?</h1>

<p><space></p>

<ul>
<li>when lambda = -3
Ax = 3x
5x1 + 2x2 = 3x1
2x1 + 5x2 = 3x2
x1=-x2</li>
<li>one eigenvector = [1 -1]</li>
</ul>

  </article>
  <!-- Presenter Notes -->
</slide>

      <slide class="" id="slide-29" style="background:;">
  <hgroup>
    <h2>Principle Component Analysis</h2>
  </hgroup>
  <article>
    <h1>Eigenwhat?</h1>

<p><space></p>

<ul>
<li>when lambda = 7
5x1 + 2x2 = 7x1
2x2 + 5x2 = 7x2
x1 = x2</li>
<li>another eigenvector = [1 1]</li>
</ul>

  </article>
  <!-- Presenter Notes -->
</slide>

      <slide class="" id="slide-30" style="background:;">
  <hgroup>
    <h2>Principle Component Analysis</h2>
  </hgroup>
  <article>
    <h1>Eigenwhat?</h1>

<p><space></p>

<p>A%<em>%c(1,-1) == 3 * as.matrix(c(1,-1))
A%</em>%c(1,1) == 7 * as.matrix(c(1,1))
roots</p>

  </article>
  <!-- Presenter Notes -->
</slide>

      <slide class="" id="slide-31" style="background:;">
  <hgroup>
    <h2>Principle Component Analysis</h2>
  </hgroup>
  <article>
    <h1>Eigenwhat?</h1>

<p><space></p>

<ul>
<li>check
m &lt;- matrix(c(1,-1,1,1),ncol=2)
m &lt;- m/sqrt(norm(m))
as.matrix(m%<em>%diag(roots)%</em>%t(m))</li>
<li>lambda is a diagonal matrix, with 0 off diagonals</li>
</ul>

  </article>
  <!-- Presenter Notes -->
</slide>

      <slide class="" id="slide-32" style="background:;">
  <hgroup>
    <h2>Principle Component Analysis</h2>
  </hgroup>
  <article>
    <h1>Motivation</h1>

<p><space></p>

<p>PX = Y</p>

<p>CY = (1/(n-1))*YYt
=PX(PX)t
=PXXtPt
=PAPt</p>

<h1>P is a matrix with columns that are eigenvectors</h1>

<h1>A is a diagonalized matrix of eigenvalues (by linear algebra) and symmetric</h1>

<p>A = EDEt</p>

  </article>
  <!-- Presenter Notes -->
</slide>

      <slide class="" id="slide-33" style="background:;">
  <hgroup>
    <h2>Principle Component Analysis</h2>
  </hgroup>
  <article>
    <h1>Motivation</h1>

<p><space></p>

<h1>each row of P should be an eigenvector of A</h1>

<p>P=Et</p>

<h1>also note that Pt = P-1 (linear algebra)</h1>

<p>A = PtDP
CY = PPtDPPt
= (1/(n-1))*D</p>

<h1>D is a diagonal matrix, depending on how we choose P</h1>

<h1>therefore CY is diagonalized</h1>

  </article>
  <!-- Presenter Notes -->
</slide>

      <slide class="" id="slide-34" style="background:;">
  <hgroup>
    <h2>Principle Component Analysis</h2>
  </hgroup>
  <article>
    <h1>Example</h1>

<p><space></p>

<pre><code class="r">data &lt;- read.csv(&quot;tennis_data_2013.csv&quot;)
</code></pre>

<pre><code>## Warning: cannot open file &#39;tennis_data_2013.csv&#39;: No such file or
## directory
</code></pre>

<pre><code>## Error: cannot open the connection
</code></pre>

<pre><code class="r">data$Player1 &lt;- as.character(data$Player1)
</code></pre>

<pre><code>## Error: object of type &#39;closure&#39; is not subsettable
</code></pre>

<pre><code class="r">data$Player2 &lt;- as.character(data$Player2)
</code></pre>

<pre><code>## Error: object of type &#39;closure&#39; is not subsettable
</code></pre>

<pre><code class="r">
tennis &lt;- data
m &lt;- length(data)

for (i in 10:m) {
    tennis[, i] &lt;- ifelse(is.na(data[, i]), 0, data[, i])
}
</code></pre>

<pre><code>## Error: object of type &#39;closure&#39; is not subsettable
</code></pre>

<pre><code class="r">
str(tennis)
</code></pre>

<pre><code>## function (..., list = character(), package = NULL, lib.loc = NULL, 
##     verbose = getOption(&quot;verbose&quot;), envir = .GlobalEnv)
</code></pre>

<pre><code class="r">
features &lt;- tennis[, 10:m]
</code></pre>

<pre><code>## Error: object of type &#39;closure&#39; is not subsettable
</code></pre>

<pre><code class="r">
head(features)
</code></pre>

<pre><code>## Error: object &#39;features&#39; not found
</code></pre>

<pre><code class="r">str(features)
</code></pre>

<pre><code>## Error: object &#39;features&#39; not found
</code></pre>

<pre><code class="r">dim(features)
</code></pre>

<pre><code>## Error: object &#39;features&#39; not found
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

      <slide class="" id="slide-35" style="background:;">
  <hgroup>
    <h2>Principle Component Analysis</h2>
  </hgroup>
  <article>
    <h1>Example</h1>

<p><space></p>

<pre><code class="r">scaled_features &lt;- as.matrix(scale(features))
</code></pre>

<pre><code>## Error: object &#39;features&#39; not found
</code></pre>

<pre><code class="r">Cx &lt;- cov(scaled_features)
</code></pre>

<pre><code>## Error: object &#39;scaled_features&#39; not found
</code></pre>

<pre><code class="r">eigenvalues &lt;- eigen(Cx)$values
</code></pre>

<pre><code>## Error: object &#39;Cx&#39; not found
</code></pre>

<pre><code class="r">eigenvectors &lt;- eigen(Cx)$vectors
</code></pre>

<pre><code>## Error: object &#39;Cx&#39; not found
</code></pre>

<pre><code class="r">PC &lt;- scaled_features %*% eigenvectors
</code></pre>

<pre><code>## Error: object &#39;scaled_features&#39; not found
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

      <slide class="" id="slide-36" style="background:;">
  <hgroup>
    <h2>Principle Component Analysis</h2>
  </hgroup>
  <article>
    <h1>Example</h1>

<p><space></p>

<pre><code class="r">Cy &lt;- cov(PC)
</code></pre>

<pre><code>## Error: object &#39;PC&#39; not found
</code></pre>

<pre><code class="r">sum(round(diag(Cy) - eigenvalues, 5))
</code></pre>

<pre><code>## Error: object &#39;Cy&#39; not found
</code></pre>

<pre><code class="r">sum(round(Cy[upper.tri(Cy)], 5))  ## off diagonals are 0 since PC&#39;s are orthogonal
</code></pre>

<pre><code>## Error: object &#39;Cy&#39; not found
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

      <slide class="" id="slide-37" style="background:;">
  <hgroup>
    <h2>Principle Component Analysis</h2>
  </hgroup>
  <article>
    <h1>Example</h1>

<p><space></p>

<pre><code class="r">var_explained &lt;- round(eigenvalues/sum(eigenvalues) * 100, digits = 2)
</code></pre>

<pre><code>## Error: object &#39;eigenvalues&#39; not found
</code></pre>

<pre><code class="r">cum_var_explained &lt;- round(cumsum(eigenvalues)/sum(eigenvalues) * 100, digits = 2)
</code></pre>

<pre><code>## Error: object &#39;eigenvalues&#39; not found
</code></pre>

<pre><code class="r">
var_explained &lt;- as.data.frame(var_explained)
</code></pre>

<pre><code>## Error: object &#39;var_explained&#39; not found
</code></pre>

<pre><code class="r">names(var_explained) &lt;- &quot;variance_explained&quot;
</code></pre>

<pre><code>## Error: object &#39;var_explained&#39; not found
</code></pre>

<pre><code class="r">var_explained$PC &lt;- as.numeric(rownames(var_explained))
</code></pre>

<pre><code>## Error: object &#39;var_explained&#39; not found
</code></pre>

<pre><code class="r">var_explained &lt;- cbind(var_explained, cum_var_explained)
</code></pre>

<pre><code>## Error: object &#39;var_explained&#39; not found
</code></pre>

<pre><code class="r">
library(ggplot2)
ggplot(var_explained) + geom_bar(aes(x = PC, y = variance_explained), stat = &quot;identity&quot;) + 
    geom_line(aes(x = PC, y = cum_var_explained))
</code></pre>

<pre><code>## Error: object &#39;var_explained&#39; not found
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

      <slide class="" id="slide-38" style="background:;">
  <hgroup>
    <h2>Principle Component Analysis</h2>
  </hgroup>
  <article>
    <h1>Example</h1>

<p><space></p>

<pre><code class="r">pca.df &lt;- prcomp(scaled_features)
</code></pre>

<pre><code>## Error: object &#39;scaled_features&#39; not found
</code></pre>

<pre><code class="r">eigenvalues == (pca.df$sdev)^2
</code></pre>

<pre><code>## Error: object &#39;eigenvalues&#39; not found
</code></pre>

<pre><code class="r">eigenvectors[, 1] == pca.df$rotation[, 1]
</code></pre>

<pre><code>## Error: object &#39;eigenvectors&#39; not found
</code></pre>

<pre><code class="r">sum((eigenvectors[, 1])^2)
</code></pre>

<pre><code>## Error: object &#39;eigenvectors&#39; not found
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

      <slide class="" id="slide-39" style="background:;">
  <hgroup>
    <h2>Principle Component Analysis</h2>
  </hgroup>
  <article>
    <h1>Example</h1>

<p><space></p>

<pre><code class="r">rows &lt;- nrow(tennis)
pca.plot &lt;- as.data.frame(pca.df$x[, 1:2])
</code></pre>

<pre><code>## Error: object &#39;pca.df&#39; not found
</code></pre>

<pre><code class="r">pca.plot$gender &lt;- data$Gender
</code></pre>

<pre><code>## Error: object of type &#39;closure&#39; is not subsettable
</code></pre>

<pre><code class="r">ggplot(data = pca.plot, aes(x = PC1, y = PC2, color = gender)) + geom_point()
</code></pre>

<pre><code>## Error: object &#39;pca.plot&#39; not found
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

      <slide class="" id="slide-40" style="background:;">
  <hgroup>
    <h2>Principle Component Analysis</h2>
  </hgroup>
  <article>
    <h1>Example</h1>

<p><space></p>

<ul>
<li>how accurate is the first PC at dividing the dataset?
gen &lt;- ifelse(pca.df$x[,1] &gt; abs(mean(pca.df$x[,1]))*2,&quot;F&quot;,&quot;M&quot;)
sum(diag(table(gen,as.character(data$Gender))))/rows</li>
</ul>

  </article>
  <!-- Presenter Notes -->
</slide>

      <slide class="" id="slide-41" style="background:;">
  <hgroup>
    <h2>Principle Component Analysis</h2>
  </hgroup>
  <article>
    <h1>Summary</h1>

<p><space></p>

  </article>
  <!-- Presenter Notes -->
</slide>

      <slide class="" id="slide-42" style="background:;">
  <hgroup>
    <h2>Clustering</h2>
  </hgroup>
  <article>
    <h1>Motivation</h1>

<p><space></p>

<ul>
<li>separate data into meaningful or useful groups

<ul>
<li>capture natural structure of the data</li>
<li>starting point for further analysis</li>
</ul></li>
<li>cluster for utility

<ul>
<li>summarizing data for less expensive computation</li>
<li>data compression</li>
</ul></li>
</ul>

  </article>
  <!-- Presenter Notes -->
</slide>

      <slide class="" id="slide-43" style="background:;">
  <hgroup>
    <h2>Clustering</h2>
  </hgroup>
  <article>
    <h1>Types of Clusters</h1>

<p><space></p>

<ul>
<li>data that looks more like other data in that cluster than outside</li>
<li>each data point is more similar to the prototype (centeroid) of the cluster than the prototype of other clusters</li>
<li>where the density is highest, that is a cluster</li>
</ul>

  </article>
  <!-- Presenter Notes -->
</slide>

      <slide class="" id="slide-44" style="background:;">
  <hgroup>
    <h2>Clustering</h2>
  </hgroup>
  <article>
    <h1>Typical clustering problem</h1>

<p><space></p>

<p><img src="figure/cluster_plot_example.png" alt="plot of chunk cluster_plot_example"> </p>

  </article>
  <!-- Presenter Notes -->
</slide>

      <slide class="" id="slide-45" style="background:;">
  <hgroup>
    <h2>Clustering</h2>
  </hgroup>
  <article>
    <h1>Density based cluster</h1>

<p><space></p>

<p><img src="http://upload.wikimedia.org/wikipedia/commons/0/05/DBSCAN-density-data.svg" density_based /></p>

  </article>
  <!-- Presenter Notes -->
</slide>

      <slide class="" id="slide-46" style="background:;">
  <hgroup>
    <h2>Clustering</h2>
  </hgroup>
  <article>
    <h1>Kmeans algorithm</h1>

<p><space></p>

<ul>
<li>Select K points as initial centroids </li>
<li>Do

<ul>
<li>Form K clusters by assigning each point to its closest centroid</li>
<li>Recompute the centroid of each cluster </li>
</ul></li>
<li>Until centroids do not change, or change very minimally, i.e. &lt;1%</li>
</ul>

  </article>
  <!-- Presenter Notes -->
</slide>

      <slide class="" id="slide-47" style="background:;">
  <hgroup>
    <h2>Clustering</h2>
  </hgroup>
  <article>
    <h1>Kmeans algorithm</h1>

<p><space></p>

<ul>
<li>Use similarity measures (Euclidean or cosine) depending on the data</li>
<li>Minimize the squared distance of each point to closest centroid
\(SSE(k) = \sum_{i=1}^{m}\sum_{j=1}^{n} (x_{ij} - \bar{x}_{kj})\)</li>
</ul>

  </article>
  <!-- Presenter Notes -->
</slide>

      <slide class="" id="slide-48" style="background:;">
  <hgroup>
    <h2>Clustering</h2>
  </hgroup>
  <article>
    <h1>Kmeans - notes</h1>

<p><space></p>

<ul>
<li>Choose initial K randomly 

<ul>
<li>can lead to poor centroids - local minimuum</li>
<li>Run kmeans multiple times</li>
</ul></li>
<li>Reduce the total SSE by increasing K</li>
<li>Increase the cluster with largest SSE</li>
<li>Decrease K and minimize SSE</li>
<li>Split up a cluster into other clusters

<ul>
<li>The centroid that is split will increase total SSE the least</li>
</ul></li>
</ul>

  </article>
  <!-- Presenter Notes -->
</slide>

      <slide class="" id="slide-49" style="background:;">
  <hgroup>
    <h2>Clustering</h2>
  </hgroup>
  <article>
    <h1>Kmeans</h1>

<p><space></p>

<ul>
<li>Bisecting K means

<ul>
<li>Split points into 2 clusters</li>
<li>Take cluster with largest SSE - split that into two clusters</li>
<li>Rerun bisecting K mean on resulting clusters</li>
<li>Stop when you have K clusters</li>
</ul></li>
<li>Less susceptible to initialization problems</li>
</ul>

  </article>
  <!-- Presenter Notes -->
</slide>

      <slide class="" id="slide-50" style="background:;">
  <hgroup>
    <h2>Clustering</h2>
  </hgroup>
  <article>
    <h1>Kmean fails</h1>

<p><space></p>

<p><img src="C:/Users/Ilan%20Man/Desktop/Personal/RPres_ML_2/figure/different_density.png" alt="different_density"></p>

  </article>
  <!-- Presenter Notes -->
</slide>

      <slide class="" id="slide-51" style="background:;">
  <hgroup>
    <h2>Clustering</h2>
  </hgroup>
  <article>
    <h1>Kmean fails</h1>

<p><space></p>

<p><img src="C:/Users/Ilan%20Man/Desktop/Personal/RPres_ML_2/figure/different_size_clusters.png" alt="different_size_clusters"></p>

  </article>
  <!-- Presenter Notes -->
</slide>

      <slide class="" id="slide-52" style="background:;">
  <hgroup>
    <h2>Clustering</h2>
  </hgroup>
  <article>
    <h1>Kmean fails</h1>

<p><space></p>

<p><img src="C:/Users/Ilan%20Man/Desktop/Personal/RPres_ML_2/figure/non-globular.png" alt="non-globular"></p>

  </article>
  <!-- Presenter Notes -->
</slide>

      <slide class="" id="slide-53" style="background:;">
  <hgroup>
    <h2>Clustering</h2>
  </hgroup>
  <article>
    <h1>Kmeans</h1>

<p><space></p>

<pre><code class="r"># wine &lt;-
# read.csv(&#39;http://archive.ics.uci.edu/ml/machine-learning-databases/wine/wine.data&#39;)
names(wine) &lt;- c(&quot;class&quot;, &quot;Alcohol&quot;, &quot;Malic&quot;, &quot;Ash&quot;, &quot;Alcalinity&quot;, &quot;Magnesium&quot;, 
    &quot;Total_phenols&quot;, &quot;Flavanoids&quot;, &quot;NFphenols&quot;, &quot;Proanthocyanins&quot;, &quot;Color&quot;, 
    &quot;Hue&quot;, &quot;Diluted&quot;, &quot;Proline&quot;)
</code></pre>

<pre><code>## Error: object &#39;wine&#39; not found
</code></pre>

<pre><code class="r">str(wine)
</code></pre>

<pre><code>## Error: object &#39;wine&#39; not found
</code></pre>

<ul>
<li>set.seed() to make sure results are reproducible</li>
<li>add nstart to the function call so that it attempts multiple configurations, selecting the best</li>
<li>use a screeplot to select optimal K</li>
</ul>

  </article>
  <!-- Presenter Notes -->
</slide>

      <slide class="" id="slide-54" style="background:;">
  <hgroup>
    <h2>Clustering</h2>
  </hgroup>
  <article>
    <h1>Kmeans</h1>

<p><space></p>

<pre><code class="r">wine &lt;- scale(wine[, -1])
</code></pre>

<pre><code>## Error: object &#39;wine&#39; not found
</code></pre>

<pre><code class="r">best_k &lt;- 0
num_k &lt;- 20
for (i in 1:num_k) {
    best_k[i] &lt;- sum(kmeans(wine, centers = i)$withinss)
}
</code></pre>

<pre><code>## Error: object &#39;wine&#39; not found
</code></pre>

<pre><code class="r">
barplot(best_k, xlab = &quot;Number of clusters&quot;, names.arg = 1:num_k, ylab = &quot;Within groups sum of squares&quot;, 
    main = &quot;Scree Plot for Wine dataset&quot;)
</code></pre>

<pre><code>## Error: incorrect number of names
</code></pre>

<p><img src="figure/unnamed-chunk-7.png" alt="plot of chunk unnamed-chunk-7"> </p>

  </article>
  <!-- Presenter Notes -->
</slide>

      <slide class="" id="slide-55" style="background:;">
  <hgroup>
    <h2>Clustering</h2>
  </hgroup>
  <article>
    <h1>Kmeans animation</h1>

<p><space></p>

<p>install.packages(&#39;animation&#39;)
library(animation)</p>

<p>oopt = ani.options(interval = 1)
ani_ex = rbind(matrix(rnorm(100, sd = 0.3), ncol = 2), 
          matrix(rnorm(100, sd = 0.3), 
          ncol = 2))
colnames(ani_ex) = c(&quot;x&quot;, &quot;y&quot;)</p>

<p>kmeans.an = function(
  x = cbind(X1 = runif(50), X2 = runif(50)), centers = 4, hints = c(&#39;Move centers!&#39;, &#39;Find cluster?&#39;),
  pch = 1:5, col = 1:5
) {
  x = as.matrix(x)
  ocluster = sample(centers, nrow(x), replace = TRUE)
  if (length(centers) == 1) centers = x[sample(nrow(x), centers), ] else
    centers = as.matrix(centers)
  numcent = nrow(centers)
  dst = matrix(nrow = nrow(x), ncol = numcent)
  j = 1
  pch = rep(pch, length = numcent)
  col = rep(col, length = numcent)</p>

<p>for (j in 1:ani.options(&#39;nmax&#39;)) {
    dev.hold()
    plot(x, pch = pch[ocluster], col = col[ocluster], panel.first = grid())
    mtext(hints[1], 4)
    points(centers, pch = pch[1:numcent], cex = 3, lwd = 2, col = col[1:numcent])
    ani.pause()
    for (i in 1:numcent) {
      dst[, i] = sqrt(apply((t(t(x) - unlist(centers[i, ])))<sup>2,</sup> 1, sum))
    }
    ncluster = apply(dst, 1, which.min)
    plot(x, type = &#39;n&#39;)
    mtext(hints[2], 4)
    grid()
    ocenters = centers
    for (i in 1:numcent) {
      xx = subset(x, ncluster == i)
      polygon(xx[chull(xx), ], density = 10, col = col[i], lty = 2)
      points(xx, pch = pch[i], col = col[i])
      centers[i, ] = apply(xx, 2, mean)
    }
    points(ocenters, cex = 3, col = col[1:numcent], pch = pch[1:numcent], lwd = 2)
    ani.pause()
    if (all(ncluster == ocluster)) break
    ocluster = ncluster
  }
  invisible(list(cluster = ncluster, centers = centers))
}</p>

<p>kmeans.an(ani_ex, centers = 5, hints = c(&quot;Move centers&quot;,&quot;Cluster found?&quot;))</p>

  </article>
  <!-- Presenter Notes -->
</slide>

      <slide class="" id="slide-56" style="background:;">
  <hgroup>
    <h2>Clustering</h2>
  </hgroup>
  <article>
    <h1>K-medoid</h1>

<p><space></p>

<ul>
<li>multiple distance metrics</li>
<li>robust medioids</li>
<li>computationally expensive</li>
<li>cluster center is one of the points itself</li>
</ul>

  </article>
  <!-- Presenter Notes -->
</slide>

      <slide class="" id="slide-57" style="background:;">
  <hgroup>
    <h2>Clustering</h2>
  </hgroup>
  <article>
    <h1>K-medoid</h1>

<p><space></p>

<ul>
<li>cluster each point based on the closest center</li>
<li>replace each center by the medioid of points in its cluster</li>
</ul>

  </article>
  <!-- Presenter Notes -->
</slide>

      <slide class="" id="slide-58" style="background:;">
  <hgroup>
    <h2>Clustering</h2>
  </hgroup>
  <article>
    <h1>K-medoid</h1>

<p><space></p>

<pre><code class="r">library(cluster)
## generate 25 objects, divided into 2 clusters.
x &lt;- rbind(cbind(rnorm(10, 0, 0.5), rnorm(10, 0, 0.5)), cbind(rnorm(15, 5, 0.5), 
    rnorm(15, 5, 0.5)))
pamx &lt;- pam(x, 2)
summary(pamx)
</code></pre>

<pre><code>## Medoids:
##      ID                
## [1,]  4 -0.1848 -0.2264
## [2,] 11  4.8207  4.9879
## Clustering vector:
##  [1] 1 1 1 1 1 1 1 1 1 1 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2
## Objective function:
##  build   swap 
## 0.7233 0.5272 
## 
## Numerical information per cluster:
##      size max_diss av_diss diameter separation
## [1,]   10   0.9003   0.382    1.173      5.867
## [2,]   15   1.4748   0.624    2.386      5.867
## 
## Isolated clusters:
##  L-clusters: character(0)
##  L*-clusters: [1] 1 2
## 
## Silhouette plot information:
##    cluster neighbor sil_width
## 4        1        2    0.9418
## 2        1        2    0.9388
## 9        1        2    0.9356
## 7        1        2    0.9304
## 6        1        2    0.9271
## 5        1        2    0.9192
## 10       1        2    0.9137
## 3        1        2    0.9058
## 8        1        2    0.8885
## 1        1        2    0.8731
## 11       2        1    0.9073
## 21       2        1    0.9041
## 25       2        1    0.9024
## 15       2        1    0.8984
## 16       2        1    0.8954
## 23       2        1    0.8929
## 12       2        1    0.8876
## 14       2        1    0.8731
## 18       2        1    0.8726
## 13       2        1    0.8644
## 20       2        1    0.8627
## 22       2        1    0.8426
## 17       2        1    0.8315
## 19       2        1    0.8145
## 24       2        1    0.7842
## Average silhouette width per cluster:
## [1] 0.9174 0.8689
## Average silhouette width of total data set:
## [1] 0.8883
## 
## 300 dissimilarities, summarized :
##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##   0.036   0.752   4.130   4.060   7.230   9.250 
## Metric :  euclidean 
## Number of objects : 25
## 
## Available components:
##  [1] &quot;medoids&quot;    &quot;id.med&quot;     &quot;clustering&quot; &quot;objective&quot;  &quot;isolation&quot; 
##  [6] &quot;clusinfo&quot;   &quot;silinfo&quot;    &quot;diss&quot;       &quot;call&quot;       &quot;data&quot;
</code></pre>

<pre><code class="r">clusplot(pamx, main = &quot;K-medoids with K = 2&quot;, sub = NULL)
</code></pre>

<p><img src="figure/kmedoid_example.png" alt="plot of chunk kmedoid_example"> </p>

<h2><a href="http://www.bvmengineering.ac.in/docs/published%20papers/cpit/cpit/201405.pdf">http://www.bvmengineering.ac.in/docs/published%20papers/cpit/cpit/201405.pdf</a></h2>

<h2>Clustering</h2>

<h1>DBSCAN</h1>

<p><space></p>

<ul>
<li>density based

<ul>
<li>center based approach to finding density</li>
<li>count the number of points within some radius of a point, the radius is call Eps</li>
<li>if Eps is too big, there will be m points, if eps is too small, there will be 1 point</li>
<li>core point has X points within a radius of Eps, border points are within a radius of Eps of core point, and noise points are not within Eps of border or core points</li>
<li>if p is density connected to q, they are part of the same cluster, if not, then they are not; if p is not density connected to any other point, its considered noise</li>
</ul></li>
</ul>

<hr>

<h2>Clustering</h2>

<h1>DBSCAN</h1>

<p><space></p>

<pre><code class="r">x &lt;- c(2, 2, 8, 5, 7, 6, 1, 4)
y &lt;- c(10, 5, 4, 8, 5, 4, 2, 9)
cluster &lt;- data.frame(X = c(x, 2 * x, 3 * x), Y = c(y, -2 * x, 1/4 * y))
plot(cluster)
</code></pre>

<p><img src="figure/unnamed-chunk-8.png" alt="plot of chunk unnamed-chunk-8"> </p>

  </article>
  <!-- Presenter Notes -->
</slide>

      <slide class="" id="slide-59" style="background:;">
  <hgroup>
    <h2>Clustering</h2>
  </hgroup>
  <article>
    <h1>DBSCAN</h1>

<p><space></p>

<pre><code class="r">library(fpc)
cluster_DBSCAN &lt;- dbscan(cluster, eps = 3, MinPts = 2, method = &quot;hybrid&quot;)
plot(cluster_DBSCAN, cluster, main = &quot;Clustering using DBSCAN algorithm (eps=3, MinPts=3)&quot;)
</code></pre>

<p><img src="figure/dbscan_ex.png" alt="plot of chunk dbscan_ex"> </p>

  </article>
  <!-- Presenter Notes -->
</slide>

      <slide class="" id="slide-60" style="background:;">
  <hgroup>
    <h2>Clustering</h2>
  </hgroup>
  <article>
    <h1>Summary</h1>

<p><space></p>

  </article>
  <!-- Presenter Notes -->
</slide>

      <slide class="" id="slide-61" style="background:;">
  <hgroup>
    <h2>Trees</h2>
  </hgroup>
  <article>
    <h1>Motivation</h1>

<p><space></p>

<ul>
<li>representation of decisions made in order to classify or predict
<img src="/Users/ilanman/Desktop/Data/RPres_ML_2/figure/tree_example.png" alt="overview"></li>
</ul>

  </article>
  <!-- Presenter Notes -->
</slide>

      <slide class="" id="slide-62" style="background:;">
  <hgroup>
    <h2>Trees</h2>
  </hgroup>
  <article>
    <h1>Structure</h1>

<p><space></p>

<p><img src="/Users/ilanman/Desktop/Data/RPres_ML_2/figure/tree_structure.png" alt="structure"></p>

  </article>
  <!-- Presenter Notes -->
</slide>

      <slide class="" id="slide-63" style="background:;">
  <hgroup>
    <h2>Trees</h2>
  </hgroup>
  <article>
    <h1>Structure</h1>

<p><space></p>

<ul>
<li>recursive partitioning -&gt; &quot;divide and conquer&quot;</li>
<li>going down, choose feature that is most <em>predictive</em> of target class

<ul>
<li>split the data according to feature</li>
<li>continue...</li>
</ul></li>
</ul>

  </article>
  <!-- Presenter Notes -->
</slide>

      <slide class="" id="slide-64" style="background:;">
  <hgroup>
    <h2>Trees</h2>
  </hgroup>
  <article>
    <h1>Structure</h1>

<p><space></p>

<p>until...</p>

<ul>
<li>all examples at a node are in same class</li>
<li>no more features left to distinguish (prone to overfitting)</li>
<li>tree has grown to some prespecified limit (prune)</li>
</ul>

  </article>
  <!-- Presenter Notes -->
</slide>

      <slide class="" id="slide-65" style="background:;">
  <hgroup>
    <h2>Trees</h2>
  </hgroup>
  <article>
    <h1>Algorithms</h1>

<p><space></p>

<ul>
<li>ID3

<ul>
<li>original, popular, DT implementation</li>
</ul></li>
<li>C4.5

<ul>
<li>like ID3 +</li>
<li>handles continuous cases</li>
<li>imputing missing values</li>
<li>weighing costs</li>
<li>pruning post creation</li>
</ul></li>
<li>C5.0

<ul>
<li>like C4.5 + </li>
<li>faster, less memory usage</li>
<li>boosting</li>
</ul></li>
</ul>

  </article>
  <!-- Presenter Notes -->
</slide>

      <slide class="" id="slide-66" style="background:;">
  <hgroup>
    <h2>Trees</h2>
  </hgroup>
  <article>
    <h1>Selecting features</h1>

<p><space></p>

<ul>
<li>How does tree decide how to select feature?

<ul>
<li>purity of resulting split</li>
</ul></li>
<li><strong>Entropy</strong>: amount of information contained in a random variable

<ul>
<li>For a feature with N classes:</li>
<li>0 = purely homogenous</li>
<li>\(\log_{2}(N)\) = completely mixed</li>
</ul></li>
</ul>

  </article>
  <!-- Presenter Notes -->
</slide>

      <slide class="" id="slide-67" style="background:;">
  <hgroup>
    <h2>Trees</h2>
  </hgroup>
  <article>
    <h1>Entropy</h1>

<p><space></p>

<p>\(Entropy(S) = \sum_{i=1}^{c} -p_{i}\log_{2}(p_{i})\)</p>

<ul>
<li>where \(S\) is a dataset</li>
<li>\(c\) is the number of levels in that data</li>
<li>\(p_{i}\) is the proportion of values in that level</li>
</ul>

  </article>
  <!-- Presenter Notes -->
</slide>

      <slide class="" id="slide-68" style="background:;">
  <hgroup>
    <h2>Trees</h2>
  </hgroup>
  <article>
    <h1>Entropy - example</h1>

<p><space></p>

<p>What is the entropy of a fair, 6 sided die?</p>

<pre><code class="r">entropy &lt;- function(probs) {
    ent &lt;- 0
    for (i in probs) {
        ent_temp &lt;- -i * log2(i)
        ent &lt;- ent + ent_temp
    }
    return(ent)
}
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

      <slide class="" id="slide-69" style="background:;">
  <hgroup>
    <h2>Trees</h2>
  </hgroup>
  <article>
    <h1>Entropy - example</h1>

<p><space></p>

<pre><code class="r">fair &lt;- rep(1/6, 6)
entropy(fair)
</code></pre>

<pre><code>## [1] 2.585
</code></pre>

<pre><code class="r">log2(6)
</code></pre>

<pre><code>## [1] 2.585
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

      <slide class="" id="slide-70" style="background:;">
  <hgroup>
    <h2>Trees</h2>
  </hgroup>
  <article>
    <h1>Entropy - example</h1>

<p><space></p>

<p>What is the entropy of a biased, 6 sided die?</p>

<ul>
<li>\(P(X=1) = P(X=2) = P(X=3) = 1/9\)</li>
<li>\(P(X=4) = P(X=5) = P(X=6) = 2/9\)</li>
</ul>

<pre><code class="r">biased &lt;- c(rep(1/9, 3), rep(2/9, 3))
entropy(biased)
</code></pre>

<pre><code>[1] 2.503
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

      <slide class="" id="slide-71" style="background:;">
  <hgroup>
    <h2>Trees</h2>
  </hgroup>
  <article>
    <h1>Entropy - example</h1>

<p><space></p>

<pre><code class="r">more_biased &lt;- c(rep(1/18, 3), rep(5/18, 3))
entropy(more_biased)
</code></pre>

<pre><code>[1] 2.235
</code></pre>

<pre><code class="r">
most_biased &lt;- c(rep(1/100, 5), rep(95/100, 1))
entropy(most_biased)
</code></pre>

<pre><code>[1] 0.4025
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

      <slide class="" id="slide-72" style="background:;">
  <hgroup>
    <h2>Trees</h2>
  </hgroup>
  <article>
    <h1>Entropy - example</h1>

<p><space></p>

<pre><code class="r">curve(-x * log2(x) - (1 - x) * log2(1 - x), col = &quot; red&quot;, xlab = &quot;x&quot;, ylab = &quot;Entropy&quot;, 
    lwd = 4, main = &quot;Entropy of a coin toss&quot;)
</code></pre>

<p><img src="figure/entropy_curve.png" alt="plot of chunk entropy_curve"> </p>

  </article>
  <!-- Presenter Notes -->
</slide>

      <slide class="" id="slide-73" style="background:;">
  <hgroup>
    <h2>Trees</h2>
  </hgroup>
  <article>
    <h1>Entropy</h1>

<p><space></p>

<ul>
<li>C5.0 uses the change in entropy to determine the change in purity</li>
<li><p>InfoGain = Entropy (pre split) - Entropy (post split)</p>

<ul>
<li>Entropy (pre split) = current Entropy</li>
<li>Entropy (post split) is trickier</li>
<li>need to consider Entropy of each possible split</li>
<li>\(E(post) = \sum_{i=1}^{n}w_{i}Entropy(P_{i})\)</li>
</ul></li>
<li><p>Notes:</p>

<ul>
<li>The more a feature splits the data in obvious ways, the less informative it is, entropy is lower</li>
<li>The more a feature splits the data - in general - the higher the entropy and hence information gained by splitting at that feature</li>
</ul></li>
</ul>

  </article>
  <!-- Presenter Notes -->
</slide>

      <slide class="" id="slide-74" style="background:;">
  <hgroup>
    <h2>Trees</h2>
  </hgroup>
  <article>
    <h1>Example</h1>

<p><space></p>

<pre><code class="r">voting_data &lt;- read.csv(&quot;http://archive.ics.uci.edu/ml/machine-learning-databases/voting-records/house-votes-84.data&quot;)
</code></pre>

<pre><code>## Warning: InternetOpenUrl failed: &#39;The operation timed out&#39;
</code></pre>

<pre><code>## Error: cannot open the connection
</code></pre>

<pre><code class="r">names(voting_data) &lt;- c(&quot;party&quot;, &quot;handicapped-infants&quot;, &quot;water-project-cost-sharing&quot;, 
    &quot;adoption-of-the-budget-resolution&quot;, &quot;physician-fee-freeze&quot;, &quot;el-salvador-aid&quot;, 
    &quot;religious-groups-in-schools&quot;, &quot;anti-satellite-test-ban&quot;, &quot;aid-to-nicaraguan-contras&quot;, 
    &quot;mx-missile&quot;, &quot;immigration&quot;, &quot;synfuels-corporation-cutback&quot;, &quot;education-spending&quot;, 
    &quot;superfund-right-to-sue&quot;, &quot;crime&quot;, &quot;duty-free-exports&quot;, &quot;export-administration-act-south-africa&quot;)
</code></pre>

<pre><code>## Error: object &#39;voting_data&#39; not found
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

      <slide class="" id="slide-75" style="background:;">
  <hgroup>
    <h2>Trees</h2>
  </hgroup>
  <article>
    <h1>Example</h1>

<p><space></p>

<pre><code class="r">prop.table(table(voting_data[, 1]))
</code></pre>

<pre><code>Error: object &#39;voting_data&#39; not found
</code></pre>

<pre><code class="r">n &lt;- nrow(voting_data)
</code></pre>

<pre><code>Error: object &#39;voting_data&#39; not found
</code></pre>

<pre><code class="r">train_ind &lt;- sample(n, 2/3 * n)
</code></pre>

<pre><code>Error: object &#39;n&#39; not found
</code></pre>

<pre><code class="r">voting_train &lt;- voting_data[train_ind, ]
</code></pre>

<pre><code>Error: object &#39;voting_data&#39; not found
</code></pre>

<pre><code class="r">voting_test &lt;- voting_data[-train_ind, ]
</code></pre>

<pre><code>Error: object &#39;voting_data&#39; not found
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

      <slide class="" id="slide-76" style="background:;">
  <hgroup>
    <h2>Trees</h2>
  </hgroup>
  <article>
    <h1>Example</h1>

<p><space></p>

<p><img src="/Users/ilanman/Desktop/Data/RPres_ML_2/figure/real_tree_example.png" height="500px" width="500px" /></p>

<pre><code>## Error: object &#39;voting_train&#39; not found
</code></pre>

<pre><code>## Error: object &#39;tree_formula&#39; not found
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

      <slide class="" id="slide-77" style="background:;">
  <hgroup>
    <h2>Trees</h2>
  </hgroup>
  <article>
    <h1>Example</h1>

<p><space></p>

<pre><code>Error: object &#39;voting_train&#39; not found
</code></pre>

<pre><code>Error: error in evaluating the argument &#39;object&#39; in selecting a method for function &#39;predict&#39;: Error: object &#39;tree_model&#39; not found
</code></pre>

<pre><code>Error: object &#39;voting_test&#39; not found
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

      <slide class="" id="slide-78" style="background:;">
  <hgroup>
    <h2>Trees</h2>
  </hgroup>
  <article>
    <h1>Example</h1>

<p><space></p>

<pre><code class="r"># most important variables
head(C5imp(tree_model))
</code></pre>

<pre><code>## Error: object &#39;tree_model&#39; not found
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

      <slide class="" id="slide-79" style="background:;">
  <hgroup>
    <h2>Trees</h2>
  </hgroup>
  <article>
    <h1>Example</h1>

<p><space></p>

<pre><code class="r"># in-sample error rate
summary(tree_model)
</code></pre>

<pre><code>## Error: object &#39;tree_model&#39; not found
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

      <slide class="" id="slide-80" style="background:;">
  <hgroup>
    <h2>Trees</h2>
  </hgroup>
  <article>
    <h1>Boosting</h1>

<p><space></p>

<ul>
<li>by combining a number of weak performing learners create a team that is much stronger than any one of the learners alone.</li>
<li>this is where C5.0 improves on C4.5</li>
</ul>

  </article>
  <!-- Presenter Notes -->
</slide>

      <slide class="" id="slide-81" style="background:;">
  <hgroup>
    <h2>Trees</h2>
  </hgroup>
  <article>
    <h1>Example - Boosting</h1>

<p><space></p>

<pre><code class="r">boosted_tree_model &lt;- C5.0(voting_train[, -1], voting_train[, 1], trials = 25)
</code></pre>

<pre><code>## Error: object &#39;voting_train&#39; not found
</code></pre>

<pre><code class="r">boosted_tennis_predict &lt;- predict(boosted_tree_model, voting_test[, -1])
</code></pre>

<pre><code>## Error: error in evaluating the argument &#39;object&#39; in selecting a method for function &#39;predict&#39;: Error: object &#39;boosted_tree_model&#39; not found
</code></pre>

<pre><code class="r">
boosted_conf &lt;- CrossTable(voting_test[, 1], boosted_tennis_predict, prop.chisq = FALSE, 
    prop.c = FALSE, prop.r = FALSE, dnn = c(&quot;actual class&quot;, &quot;predicted class&quot;))
</code></pre>

<pre><code>## Error: object &#39;voting_test&#39; not found
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

      <slide class="" id="slide-82" style="background:;">
  <hgroup>
    <h2>Trees</h2>
  </hgroup>
  <article>
    <h1>Example - Boosting</h1>

<p><space></p>

<pre><code class="r"># in-sample error rate
summary(boosted_tree_model)
</code></pre>

<pre><code>## Error: object &#39;boosted_tree_model&#39; not found
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

      <slide class="" id="slide-83" style="background:;">
  <hgroup>
    <h2>Trees</h2>
  </hgroup>
  <article>
    <h1>Error Cost</h1>

<p><space></p>

<ul>
<li>still getting too many false positives (predict republican but actually democrat)</li>
<li>introduce higher cost to getting this wrong</li>
</ul>

<pre><code class="r">error_cost &lt;- matrix(c(0, 1, 2, 0), nrow = 2)
cost_model &lt;- C5.0(voting_train[, -1], voting_train[, 1], trials = 1, costs = error_cost)
</code></pre>

<pre><code>## Error: object &#39;voting_train&#39; not found
</code></pre>

<pre><code class="r">cost_predict &lt;- predict(cost_model, newdata = voting_test[, -1])
</code></pre>

<pre><code>## Error: error in evaluating the argument &#39;object&#39; in selecting a method for function &#39;predict&#39;: Error: object &#39;cost_model&#39; not found
</code></pre>

<pre><code class="r">conf &lt;- CrossTable(voting_test[, 1], cost_predict, prop.chisq = FALSE, prop.c = FALSE, 
    prop.r = FALSE, dnn = c(&quot;actual class&quot;, &quot;predicted class&quot;))
</code></pre>

<pre><code>## Error: object &#39;voting_test&#39; not found
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

      <slide class="" id="slide-84" style="background:;">
  <hgroup>
    <h2>Trees</h2>
  </hgroup>
  <article>
    <h1>Error Cost</h1>

<p><space></p>

<pre><code>## Error: object &#39;voting_train&#39; not found
</code></pre>

<pre><code>## Warning: no non-missing arguments to min; returning Inf
## Warning: no non-missing arguments to max; returning -Inf
## Warning: no non-missing arguments to min; returning Inf
## Warning: no non-missing arguments to max; returning -Inf
</code></pre>

<pre><code>## Error: need finite &#39;xlim&#39; values
</code></pre>

<p><img src="figure/plot_boost_acc.png" alt="plot of chunk plot_boost_acc"> </p>

  </article>
  <!-- Presenter Notes -->
</slide>

      <slide class="" id="slide-85" style="background:;">
  <hgroup>
    <h2>Trees</h2>
  </hgroup>
  <article>
    <h1>Pros and Cons</h1>

<p><space></p>

<ul>
<li>trees are non-parametric, rule based classification or regression method</li>
<li>simple to understand and interpret</li>
<li>little data preparation</li>
<li>works well with small or large number of features
<br></li>
<li>easy to overfit</li>
<li>biased towards splits on features with large number of levels</li>
<li>usually finds local optimum</li>
<li>difficult concepts are hard to learn</li>
<li>avoid pre-pruning</li>
<li>hard to know optimal length of tree without growing it there first</li>
</ul>

  </article>
  <!-- Presenter Notes -->
</slide>

      <slide class="" id="slide-86" style="background:;">
  <hgroup>
    <h2>Resources</h2>
  </hgroup>
  <article>
    <p><space></p>

<ul>
<li><a href="http://www.packtpub.com/machine-learning-with-r/book">Machine Learning with R</a></li>
<li><a href="http://shop.oreilly.com/product/0636920018483.do">Machine Learning for Hackers</a></li>
<li><a href="http://web.stanford.edu/%7Ehastie/local.ftp/Springer/OLD/ESLII_print4.pdf">Elements of Statistical Learning</a></li>
</ul>

  </article>
  <!-- Presenter Notes -->
</slide>

      <slide class="" id="slide-87" style="background:;">
  <hgroup>
    
  </hgroup>
  <article>
    
  </article>
  <!-- Presenter Notes -->
</slide>

    <slide class="backdrop"></slide>
  </slides>

  <!--[if IE]>
    <script 
      src="http://ajax.googleapis.com/ajax/libs/chrome-frame/1/CFInstall.min.js">  
    </script>
    <script>CFInstall.check({mode: 'overlay'});</script>
  <![endif]-->
</body>
<!-- Grab CDN jQuery, fall back to local if offline -->
<script src="http://ajax.aspnetcdn.com/ajax/jQuery/jquery-1.7.min.js"></script>
<script>window.jQuery || document.write('<script src="libraries/widgets/quiz/js/jquery-1.7.min.js"><\/script>')</script>
<!-- Load Javascripts for Widgets -->
<!-- MathJax: Fall back to local if CDN offline but local image fonts are not supported (saves >100MB) -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [['$','$'], ['\\(','\\)']],
      processEscapes: true
    }
  });
</script>
<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/2.0-latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
<!-- <script src="https://c328740.ssl.cf1.rackcdn.com/mathjax/2.0-latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script> -->
<script>window.MathJax || document.write('<script type="text/x-mathjax-config">MathJax.Hub.Config({"HTML-CSS":{imageFont:null}});<\/script><script src="libraries/widgets/mathjax/MathJax.js?config=TeX-AMS-MML_HTMLorMML"><\/script>')
</script>
<!-- LOAD HIGHLIGHTER JS FILES -->
<script src="libraries/highlighters/highlight.js/highlight.pack.js"></script>
<script>hljs.initHighlightingOnLoad();</script>
<!-- DONE LOADING HIGHLIGHTER JS FILES -->
</html>